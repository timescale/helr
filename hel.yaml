# Hel v0.1: minimal config for validation
global:
  log_level: info
  state:
    backend: sqlite
    path: "./hel-state.db"
  health:
    enabled: true
    address: "0.0.0.0"
    port: 8080
  metrics:
    enabled: true
    address: "0.0.0.0"
    port: 9090

sources:
  okta-audit:
    url: "https://${OKTA_DOMAIN}/api/v1/logs"
    schedule:
      interval_secs: 30
      jitter_secs: 5
    auth:
      type: bearer
      token_env: OKTA_API_TOKEN
    pagination:
      strategy: link_header
      rel: next
      max_pages: 100
    # Optional: stop pagination when total response body bytes exceed this (per poll)
    # max_bytes: 10485760   # 10 MiB
    # Optional: skip emitting duplicate events by ID (LRU, per source)
    # dedupe:
    #   id_field: "uuid"    # or "id", "event.id" (dotted path)
    #   capacity: 100000
    resilience:
      timeout_secs: 30
      retries:
        max_attempts: 3
        initial_backoff_secs: 1
        max_backoff_secs: 30
        multiplier: 2.0
      circuit_breaker:
        enabled: true
        failure_threshold: 5
        success_threshold: 2
        half_open_timeout_secs: 60
      rate_limit:
        respect_headers: true   # use Retry-After / X-RateLimit-Reset on 429

# OAuth2 example (e.g. Google Workspace):
#   auth:
#     type: oauth2
#     token_url: "https://oauth2.googleapis.com/token"
#     client_id_env: GWS_CLIENT_ID
#     client_secret_env: GWS_CLIENT_SECRET
#     refresh_token_env: GWS_REFRESH_TOKEN
#     scopes: []
