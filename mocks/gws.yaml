# Mock server config for Google Workspace (GWS) Admin SDK Reports API (development/testing).
# Run: hel mock-server mocks/gws.yaml
# Then in hel.yaml add a source that points at http://127.0.0.1:<port> and run:
#   hel test --source gws-login-audit
#
# GWS API: GET .../activity/users/all/applications/login
# Query: maxResults, pageToken (cursor), startTime (optional).
# Response: { "items": [...], "nextPageToken": "..." } or { "items": [] } when done.

endpoint: "/admin/reports/v1/activity/users/all/applications/login"

responses:
  # Next page (cursor)
  - match:
      query:
        pageToken: "token1"
    response:
      status: 200
      headers:
        Content-Type: "application/json"
      body: '{"items":[]}'

  # First page: with startTime or with maxResults (initial request)
  - match:
      query:
        maxResults: "*"
    response:
      status: 200
      headers:
        Content-Type: "application/json"
      body: '{"items":[{"id":{"time":"2024-01-15T12:00:00Z","uniqueQualifier":"1"},"actor":{"callerType":"USER","email":"user@example.com"},"events":[{"name":"login","type":"login"}]}],"nextPageToken":"token1"}'

  # Fallback: no query (e.g. first request without from)
  - match:
      query: {}
    response:
      status: 200
      headers:
        Content-Type: "application/json"
      body: '{"items":[{"id":{"time":"2024-01-15T12:00:00Z","uniqueQualifier":"1"},"actor":{"callerType":"USER","email":"user@example.com"},"events":[{"name":"login","type":"login"}]}],"nextPageToken":"token1"}'
